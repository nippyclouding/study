WEB SERVER : HTTP 기반 동작, 정적 리소스를 제공
- nginx, apache .. 
WEB APPLICATION SERVER : HTTP 기반 동작, 웹 서버 기능 + 프로그램 코드 로직, 동적 리소스 제공, WAS
- Tomcat, Jetty .. 

모든 데이터(JSON, XML, HTML, text, image ..)들을 HTTP 프로토콜로 전송할 수 있다.

Servlet : WAS에서 수행하는 비즈니스 로직 외 모든 것을 수행한다. (간편성)
- 소켓 연결
- 서버 tcp, udp 대기,
- 파싱
- HTML 읽기
- 응답 메시지 생성
- tcp, udp에 응답, 전달, 소켓 종료 


Servlet은 HTTP 요청, 응답 정보를 편리하게 관리할 수 있게
HttpServletRequest, HttpServletResponse를 제공한다. (개발자가 직접 파싱하지 않아도 된다.)
서블릿 동작
1. HTTP 요청 시 WAS에서 request, response 객체를 생성 후 서블릿 객체를 호출한다.
2. 서블릿 객체를 통해 개발자는 request, response 객체에 HTTP 응답, 요청 정보를 편리하게 저장하거나 조회할 수 있다.
3. WAS는 response 객체 속 내용으로 HTTP 응답 정보를 생성한다.

Servlet Container
Tomcat처럼 서블릿을 지원하는 WAS를 '서블릿 컨테이너' 라고 한다.
서블릿 컨테이너는 서블릿 객체를 생성, 초기화, 호출, 종료하는 생명 주기를 싱글톤으로 관리한다.
- 서블릿 객체는 싱글톤으로 생성, Http request, response 객체는 매번 새로 생성된다. (고객마다 데이터가 다르기 때문)
- 서블릿 객체는 최초 로딩 시점에 서블릿 객체를 미리 만들어둔 뒤 재활용한다.
- 모든 고객들의 요청은 동일한 서블릿 객체에 접근하기에 공유 변수 사용에 주의해야 한다. (공유 변수 : 접근 시 같이 공유되는 필드)
- 서블릿 객체는 서블릿 컨테이너가 종료될 때 함께 종료된다.
- 일반적으로 고객들의 요청이 올 때마다 스레드 풀에서 스레드가 각각의 요청마다 호출되어 서블릿 객체를 조회, 전달한다.

서블릿의 장점
- 멀티 스레드를 이용하여 동시 접근을 허용 / 하나의 스레드가 지연되어도 다른 스레드들은 정상 작동한다.
- 서버 컴퓨터 리소스(cpu, 메모리)가 허용할 때까지 클라이언트(고객)의 요청을 처리 가능

서블릿의 단점
- 스레드 생성 비용은 높으며 문맥 교환 비용까지 있다.
- 스레드 생성에 제한이 없기에 클라이언트 요청이 많을 경우 서버가 다운될 수 있다.
=> 스레드 풀을 사용하여 방지 가능 (미리 스레드를 생성하여 보관)
Tomcat 서버는 최대 200개 스레드가 기본 설정으로 되어있다.
스레드 풀의 최대 생성 스레드를 낮게 잡으면 CPU 점유율이 낮으며, 서버 리소스는 여유로운데 고객 요청이 지연될 수 있다.
스레드 풀의 최대 생성 스레드를 높게 잡으면 리소스 초과로 서버 다운이 될 수 있다.(대용량 트래픽의 경우)
=> 실무에서는 장애 발생 시 클라우드 사용 중일 경우 먼저 서버를 증설, 이후 튜닝을 하고 클라우드를 사용 중이지 않을 경우 바로 튜닝 작업에 들어간다.

WAS의 주요 튜닝 포인트는 스레드 풀 내에서 '최대 스레드 수'이다.
스레드 풀 내부 스레드 수의 적정 숫자를 위해 성능 테스트를 꼭 해서 확인한다. (실제 서비스와 최대한 비슷하게 테스트)


